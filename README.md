# DPC_tools
APP隐私合规性检测工具

## 运行方法

解压static中的static.7z压缩包中的文件到static目录

运行main.py文件即可

## 评估点及标准

### 评估项：收集个人信息应明示收集目的、方式、范围

**《中华人民共和国个人信息保护法》第七条**：处理个人信息应当遵循公开、透明原则，公开个人信息处理规则，明示处理的目的、方式和范围。

**《中华人民共和国网络安全法》第四十一条**：网络运营者收集、使用个人信息，应当遵循合法、正当、必要的原则，公开收集、使用规则，明示收集、使用信息的目的、方式和范围，并经被收集者同意

**《中华人民共和国网络安全法》第四十四条**：任何个人和组织不得窃取或者以其他非法方式获取个人信息， 不得非法出售或者非法向他人提供个人信息

| 评估点                                                     | 评估标准                                                     | 方案                                                         |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 是否向用户明示收集、使用个人信息的目的、方式、范围         | 1、在用户安装、注册或首次开启App时，应主动提醒用户阅读隐私政策<br>2、当App打开系统权限时（不包括用户自行在系统设置中打开权限的情况），App应当说明该权限将收集个人信息的目的。<br>3、收集个人敏感信息时，App应通过弹窗提示等显著方式向用户明示收集、使用个人信息的目的、方式、范围。 | 1、利用uiautomator2对检测设备进行自动化操作，检测有无隐私政策弹窗<br>2、静态检测 检测应用中是否存在权限相关文本及说明文字（初步分析）<br>3、静态检测 检测应用中是否存在敏感信息相关文本及说明文字（初步分析） |
| 若使用Cookie及其同类技术收集个人信息，是否向用户明示       | 当使用Cookie等同类技术（包括脚本、Clickstream、Web  信标、Flash Cookie、内嵌 Web 链接、sdk等）收集个人信息时，应向用户明示所收集个人信息的目的、类型。 |                                                              |
| 若存在嵌入第三方代码插件收集个人信息的功能，是否向用户明示 | 如果通过嵌入第三方代码、插件等方式将个人信息传输至 第三方服务器，应通过弹窗提示等方式明确告知用户。 | 通过对安卓HTTP包的捕获分析，判断数据的流向是否为未经同意的第三方 |

### 评估项：收集使用个人信息应经用户自主选择同意，不应存在强制捆绑授权行为 

**《中华人民共和国个人信息保护法》第十四条**：基于个人同意处理个人信息的，该同意应当由个人在充分知情的前提下自愿、明确作出。法律、行政法规规定处理个人信息应当取得个人单独同意或者书面同意的，从其规定。

**《中华人民共和国个人信息保护法》第十六条**：个人信息处理者不得以个人不同意处理其个人信息或者撤回同意为由，拒绝提供产品或者服务；处理个人信息属于提供产品或者服务所必需的除外。

| 评估点                                                     | 评估标准                                                     | 方案                                                         |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 收集个人信息前是否征得用户自主选择同意                     | App收集个人信息前应提供由用户主动选择同意或不同意的选项，不同意应仅影响与所拒绝提供个人信息相关的业务功能。 | 利用uiautomator2判断隐私政策弹窗和申请权限弹窗是否存在拒绝及同意意思的按钮<br>使用Androguard对应用的APK包进行静态分析，提取其中的函数调用图。以权限申请入口点为起点，判断是否有通向程序终止点的路径 |
| 是否存在将多项业务功能和权限打包，要求用户一揽子接受的情形 | 1、不应通过捆绑App多项业务功能的方式，要求用户一 次性接受并授权同意多项业务功能收集个人信息的请求。<br>2、根据用户主动填写、点击、勾选等自主行为，作为产品或服务的业务功能开启或开始收集个人信息的条件。 |                                                              |

### 评估项：收集个人信息应满足必要性要求

**《中华人民共和国个人信息保护法》第六条**：处理个人信息应当具有明确、合理的目的，并应当与处理目的直接相关，采取对个人权益影响最小的方式。收集个人信息，应当限于实现处理目的的最小范围，不得过度收集个人信息。

| 评估点                                                 | 评估标准                                                     | 方案                                                         |
| ------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 实际收集的个人信息类型是否超出隐私政策所述范围         | 各业务功能实际收集的个人信息类型应与隐私政策所描 述内容一致，不应超出隐私政策所述范围。 | 根据app种类及隐私政策声明，确定必要信息的范围，通过静态分析及动态分析确定实际使用的信息种类，进行合规性判定 |
| 收集与业务功能有关的非必要信息，是否经用户自主选择同意 | 当App运营者收集的个人信息超出必要信息范围时，应向用户明示所收集个人信息目的并经用户自主选择同意。  <br>**注1：必要信息**指与基本业务功能直接相关，缺少该信息则基本业务功能无法实现的信息。 <br/>**注2：自主选择同意**是指个人信息主体通过书面声明或主 动做出肯定性动作，对其个人信息进行特定处理做出明确授权 的行为。肯定性动作包括个人信息主体主动作出声明（电子或 纸质形式）、主动勾选、主动点击“同意”“注册”“发送” “拨打”、主动填写或提供等。 |                                                              |
| 是否收集与业务功能无关的个人信息                       | App 不应收集与业务功能无任何关系的个人信息。                 | 根据app种类及隐私政策声明，确定必要信息的范围，通过静态分析及动态分析确定实际使用的信息种类，进行合规性判定 |
| 是否在用户明确拒绝后继续索要权限、打扰用户             | 对于用户明确拒绝使用、关闭或退出的特定业务功能，App 不应再次询问用户是否打开该业务功能或相关系统权限。 |                                                              |
| App更新是否更改系统权限设置                            | App 更新升级后，不应更改原有的系统权限设置。                 | 对app的进行纵向的版本权限使用情况分析（动态加静态）          |



## 检测策略

| 法规                                                         | 检测项目（依据《App违法违规收集使用个人信息行为认定方法》）  | 具体实施                                                     |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **《中华人民共和国个人信息保护法》第六条**：<br>处理个人信息应当具有明确、合理的目的，并应当与处理目的直接相关，采取对个人权益影响最小的方式。<br>收集个人信息，应当限于实现处理目的的最小范围，不得过度收集个人信息。 | 是否收集与其提供服务无关的个人信息（**违反必要原则，收集与其提供的服务无关的个人信息**） | 根据app种类及隐私政策声明，确定必要信息的范围，通过静态分析及动态分析确定实际使用的信息种类，进行合规性判定 |
| **《中华人民共和国个人信息保护法》第七条**：<br>处理个人信息应当遵循公开、透明原则，公开个人信息处理规则，明示处理的目的、方式和范围。<br>**《中华人民共和国网络安全法》第四十一条**：<br/>网络运营者收集、使用个人信息，应当遵循合法、正当、必要的原则，公开收集、使用规则，明示收集、使用信息的目的、方式和范围，并经被收集者同意。 | 是否有隐私政策弹窗（**未公开收集使用规则**）                 | 利用uiautomator2对检测设备进行自动化操作，检测有无隐私政策弹窗 |
| **《中华人民共和国个人信息保护法》第十四条**：<br>基于个人同意处理个人信息的，该同意应当由个人在充分知情的前提下自愿、明确作出。法律、行政法规规定处理个人信息应当取得个人单独同意或者书面同意的，从其规定。 | 未同意隐私政策和同意隐私政策后的软件行为是否合规（**未经用户同意收集使用个人信息**） | 利用uiautomator2对检测设备进行自动化操作，点击隐私政策的拒绝或同意按钮，使用Frida对关键接口的调用进行监控，判断是否存在违规行为 |
| **《中华人民共和国个人信息保护法》第十六条**：<br>个人信息处理者不得以个人不同意处理其个人信息或者撤回同意为由，拒绝提供产品或者服务；处理个人信息属于提供产品或者服务所必需的除外。 | 是否存在 “APP安装和运行时,向用户索取与当前服务无关的权限,用户拒绝授权后应用退出或关闭”情况（**违反必要原则，收集与其提供的服务无关的个人信息**） | 使用Androguard对应用的APK包进行静态分析，提取其中的函数调用图。以权限申请入口点为起点，判断是否有通向程序终止点的路径 |
| **《中华人民共和国网络安全法》第四十四条**：<br/>任何个人和组织不得窃取或者以其他非法方式获取个人信息， 不得非法出售或者非法向他人提供个人信息。 | 是否未经用户同意将个人信息提供给第三方（**未经同意向他人提供个人信息**） | 通过对安卓HTTP包的捕获分析，判断数据的流向是否为未经同意的第三方 |

## 研究点



## 检测项目

- [x] 是否有隐私政策弹窗
- [ ] 未同意隐私政策和同意隐私政策后的软件行为是否合规
- [ ] 是否收集与其提供服务无关的个人信息
- [ ] 是否未经用户同意将个人信息提供给第三方
- [ ] APP安装和运行时,向用户索取与当前服务无关的权限,用户拒绝授权后应用退出或关闭

## 静态检测

### 检测项目

- [ ] 识别应用实际调用的危险权限
- [ ] 识别应用程序的顽固权限申请行为

## 动态检测

### 检测项目

- [ ] 是否有隐私政策弹窗
- [ ] 未同意隐私政策时是否有获取用户隐私的行为
- [ ] 同意隐私政策后是否按照政策使用隐私信息

## 合规性分析



## 参考

[TongchengOpenSource/AppScan: 安全隐私卫士（AppScan）一款免费的企业级自动化App隐私合规检测工具。 (github.com)](https://github.com/TongchengOpenSource/AppScan)

[zhengjim/camille: 基于Frida的Android App隐私合规检测辅助工具 (github.com)](https://github.com/zhengjim/camille)

[XFY9326/AndroidInfo: Get latest Android versions, permissions, and API-Permission mappings (github.com)](https://github.com/XFY9326/AndroidInfo)
